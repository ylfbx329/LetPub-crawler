{% extends 'base.html' %}

{% block title %}{{ journal.name }} - 详情{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h3 class="text-center mb-4 text-dark">{{ journal.name }}</h3>

        <div class="row">
            <!-- 左侧信息卡 -->
            <div class="col-md-6">
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                        <strong>期刊概览</strong>
                        <span class="badge bg-light text-dark">ID: {{ journal.id }}</span>
                    </div>
                    <div class="card-body">
                        <p><strong>简称：</strong> {{ journal.shortname }}</p>
                        <p><strong>ISSN：</strong> {{ journal.issn }}</p>
                        <p><strong>国家：</strong> {{ journal.country }}</p>
                        <p><strong>出版社：</strong> {{ journal.publisher }}</p>
                        <p><strong>起始年份：</strong> {{ journal.start_year }}</p>
                        <p><strong>是否OA：</strong>
                            {% if journal.open_access %}
                                <span class="badge bg-success">开放</span>
                            {% else %}
                                <span class="badge bg-secondary">非开放</span>
                            {% endif %}
                        </p>
                        <p><strong>SCI分区：</strong> {{ journal.sci_part or '/' }}</p>
                        <p><strong>影响因子：</strong> <span class="badge bg-info text-dark">{{ journal.impact_factor }}</span></p>
                        <p><strong>H-Index：</strong> {{ journal.h_index }}</p>
                    </div>
                </div>

                <!-- LetPub评分展示 -->
                <div class="card shadow-sm">
                    <div class="card-header bg-warning text-dark">
                        <strong>LetPub 用户评分</strong>
                    </div>
                    <div class="card-body text-center">
                        <h2 class="display-5 text-primary">{{ letpub_rating.score }}</h2>
                        <p class="text-muted">共有 <strong>{{ letpub_rating.people }}</strong> 人评分</p>
                        <div class="progress mt-3" style="height: 20px;">
                            <div class="progress-bar bg-success" role="progressbar"
                                 style="width: {{ letpub_rating.score * 10 }}%" aria-valuenow="{{ letpub_rating.score }}"
                                 aria-valuemin="0" aria-valuemax="10">
                                {{ letpub_rating.score }}/10
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧雷达图 -->
            <div class="col-md-6">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <div id="radar" style="width: 100%; height: 400px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script>
        const radarData = {{ radar_data | tojson }};
        radar(radarData)
    </script>
{% endblock %}
